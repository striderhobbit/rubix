<div
  class="cube"
  [style]="{
    '--rotate-x': rotation.axis.x,
    '--rotate-y': rotation.axis.y,
    '--rotate-z': rotation.axis.z,
    '--rotate-a': rotation.angle
  }"
>
  <div
    *ngFor="let cubicle of cubicles"
    class="cubicle"
    [style.--twist-order]="move?.twistOrder(cubicle)"
    (animationend)="animations.next(move!.id)"
  >
    <div
      class="cubie"
      [style]="{
        '--tx': cubicle.coords.x,
        '--ty': cubicle.coords.y,
        '--tz': cubicle.coords.z
      }"
    >
      <svg
        *ngFor="let j of times(6)"
        class="cubie__face cubie__face--{{ j }}"
        viewBox="0 0 1 1"
      >
        <rect
          *ngIf="0.1 as margin"
          [attr.fill]="
            'var(--color-' + colors[permutation.pull(cubicle.index + j)] + ')'
          "
          [attr.height]="1 - 2 * margin"
          [attr.rx]="0.1"
          [attr.ry]="0.1"
          [attr.width]="1 - 2 * margin"
          [attr.x]="margin"
          [attr.y]="margin"
        ></rect>
      </svg>
    </div>
  </div>
</div>
